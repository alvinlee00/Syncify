<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Syncify - Universal Playlist Sync</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://js-cdn.music.apple.com/musickit/v1/musickit.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <h1>Syncify</h1>
                    <p>Sync playlists between your streaming services</p>
                </div>
                <a href="/admin" class="btn" style="text-decoration: none; white-space: nowrap;">
                    ⚙️ GitHub Actions Setup
                </a>
            </div>
        </header>

        <!-- Connected Services Section -->
        <div class="services-section card">
            <div class="section-header">
                <h2>Services</h2>
                <span id="connected-count" class="connected-count">0 connected</span>
            </div>

            <div id="services-grid" class="services-grid">
                <div class="loading">Loading services...</div>
            </div>

            <div id="connect-services" class="connect-services hidden">
                <h3>Add a Service</h3>
                <div id="available-services" class="available-services-grid">
                    <!-- Available services will be populated here -->
                </div>
            </div>
        </div>

        <!-- Sync Flow Section -->
        <div id="sync-section" class="sync-section card hidden">
            <div class="section-header">
                <h2>Sync Playlists</h2>
                <p>Choose source and destination, pick a playlist, and sync.</p>
            </div>

            <div class="sync-flow">
                <!-- Step 1: Service Selection -->
                <div class="sync-step card" id="step-services">
                    <h3><span class="step-number">1</span> Select Services</h3>
                    <div class="service-selectors">
                        <div class="service-selector">
                            <label for="source-service">From</label>
                            <select id="source-service" class="service-dropdown" disabled>
                                <option value="">Select source...</option>
                            </select>
                        </div>

                        <div class="sync-arrow">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                                <polyline points="12 5 19 12 12 19"></polyline>
                            </svg>
                        </div>

                        <div class="service-selector">
                            <label for="dest-service">To</label>
                            <select id="dest-service" class="service-dropdown" disabled>
                                <option value="">Select destination...</option>
                            </select>
                        </div>
                    </div>

                    <div id="sync-capabilities" class="sync-capabilities hidden">
                        <div class="capability-info">
                            <span class="capability-badge" id="isrc-support">ISRC Matching</span>
                            <span class="capability-badge" id="max-tracks">Track Limit</span>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Playlist Selection -->
                <div class="sync-step card hidden" id="step-playlists">
                    <h3><span class="step-number">2</span> Choose Playlist</h3>
                    <div class="playlist-selection">
                        <div id="source-playlists" class="source-playlists">
                            <div class="loading">Loading playlists...</div>
                        </div>
                    </div>
                </div>

                <!-- Step 3: Sync Options -->
                <div class="sync-step card hidden" id="step-options">
                    <h3><span class="step-number">3</span> Sync Options</h3>
                    <div class="sync-options">
                        <div class="option-group">
                            <label>
                                <input type="radio" name="sync-mode" value="create" checked>
                                Create new playlist
                            </label>
                            <label>
                                <input type="radio" name="sync-mode" value="update">
                                Update existing playlist
                            </label>
                        </div>

                        <div class="option-group">
                            <label for="custom-name">Playlist Name</label>
                            <input type="text" id="custom-name" placeholder="Leave blank to auto-generate">
                        </div>

                        <button id="start-sync" class="btn btn-sync-start" disabled>Start Sync</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sync Progress Modal -->
        <div id="sync-modal" class="modal hidden">
            <div class="modal-content">
                <h2>Syncing</h2>
                <div id="sync-details"></div>
                <div class="progress-container">
                    <div class="progress-bar">
                        <div id="progress-fill" class="progress-fill"></div>
                    </div>
                    <div id="progress-text" class="progress-text">0%</div>
                </div>

                <div id="sync-status" class="sync-status">
                    <div class="status-item">
                        <span class="status-label">Source</span>
                        <span id="status-source">-</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">Destination</span>
                        <span id="status-destination">-</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">Status</span>
                        <span id="status-progress">-</span>
                    </div>
                </div>

                <div id="sync-results" class="sync-results hidden">
                    <h3>Sync Complete</h3>
                    <div id="results-content"></div>
                    <button id="close-modal" class="btn btn-primary">Done</button>
                </div>
            </div>
        </div>

        <!-- Service Connection Modal -->
        <div id="service-modal" class="modal hidden">
            <div class="modal-content">
                <span class="close" id="service-modal-close">&times;</span>
                <div id="service-modal-content">
                    <!-- Service connection content will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <script src="app-enhanced.js"></script>
</body>
</html>
